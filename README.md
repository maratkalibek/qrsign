# qrsign

Стандарт QRSign для подписи через мобильные устройства (Версия 1.0)

## Общий процесс

## Данные при передаче

### Шаг 1 - Получение общих данных

#### Запрос

`GET /{id}`

#### Входящие данные

Нет

#### Исходящие данные

```
{
  "restricted": <true | false>, -- закрытый ли ресурс
  "version": "1.0" -- версия стандарта
}
```

### Шаг 2 - Получение метаданных пакета

#### Запрос

`POST /{id}`

#### Входящие данные

```
{
  "signedUrl": [
    "string" - массив из подписей
  ]
}
```

#### Исходящие данные

```
{
  "description": "string", -- описание пакета
  "documents": [ -- массив документов
    {
      "description": "string", -- описание документа
      "details": [ -- дополнительные аттрибуты для документа (в версии 1.0 действует только для XMLDSIG(-T))
        {
          "key": "elementToSignXPath" | "elementToPlaceXPath" , -- в версии 1.0 только место для подписи и элемент для подписи 
          "value": "string" -- значение
        }
      ],
      "filename": "string", -- наименование файла
      "id": "string", -- идентификатор документа
      "md5": "string", -- хэш md5 файла
      "mimeType": "string", -- MIME тип документа
      "sha1": "string", -- хэш sha1 файла
      "signType": "CADES" | "XMLDSIG" | "CADES-T" | "XMLDSIG-T", -- тип подписи
      "size": 0, -- размер файла
    }
  ],
  "id": "string", -- id запроса на сервере
  "keyCategory": "AUTHENTICATION" | "SIGNATURE", -- категория ключа необходимого для подписи 
  "name": "string" -- наименование пакета
}
```

### Шаг 3 - Получение файла

#### Запрос

`POST /{id}/{documentId}`

#### Входящие данные

```
{
  "signedUrl": [
    "string" - массив из подписей
  ]
}
```

#### Исходящие данные

Файл для скачивания

### Шаг 4 - Отправка подписей

#### Запрос

`POST /{id}/signed`

#### Входящие данные

```
{
  "signatures": [
    {
      "documentId": "string", -- id документа
      "signature": "string" -- наложенная ЭЦП
    }
  ]
}
```

#### Исходящие данные

```
{
  "signatures": [
    {
      "documentId": "string", -- id document
      "id": "string", -- id ЭЦП на сервере
    }
  ]
}
```
